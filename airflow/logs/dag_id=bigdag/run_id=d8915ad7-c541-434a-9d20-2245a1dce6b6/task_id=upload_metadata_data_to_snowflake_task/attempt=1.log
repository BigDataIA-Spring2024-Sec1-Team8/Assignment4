[2024-03-27 19:11:43,212] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: bigdag.upload_metadata_data_to_snowflake_task d8915ad7-c541-434a-9d20-2245a1dce6b6 [queued]>
[2024-03-27 19:11:43,231] {taskinstance.py:1159} INFO - Dependencies all met for <TaskInstance: bigdag.upload_metadata_data_to_snowflake_task d8915ad7-c541-434a-9d20-2245a1dce6b6 [queued]>
[2024-03-27 19:11:43,234] {taskinstance.py:1356} INFO - 
--------------------------------------------------------------------------------
[2024-03-27 19:11:43,235] {taskinstance.py:1357} INFO - Starting attempt 1 of 2
[2024-03-27 19:11:43,241] {taskinstance.py:1358} INFO - 
--------------------------------------------------------------------------------
[2024-03-27 19:11:43,356] {taskinstance.py:1377} INFO - Executing <Task(PythonOperator): upload_metadata_data_to_snowflake_task> on 2024-03-27 18:58:33.387305+00:00
[2024-03-27 19:11:43,419] {standard_task_runner.py:52} INFO - Started process 887 to run task
[2024-03-27 19:11:43,431] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'bigdag', 'upload_metadata_data_to_snowflake_task', 'd8915ad7-c541-434a-9d20-2245a1dce6b6', '--job-id', '1385', '--raw', '--subdir', 'DAGS_FOLDER/dags.py', '--cfg-path', '/tmp/tmp2s_yedx9', '--error-file', '/tmp/tmpxkpx7h3d']
[2024-03-27 19:11:43,433] {standard_task_runner.py:80} INFO - Job 1385: Subtask upload_metadata_data_to_snowflake_task
[2024-03-27 19:11:43,616] {task_command.py:369} INFO - Running <TaskInstance: bigdag.upload_metadata_data_to_snowflake_task d8915ad7-c541-434a-9d20-2245a1dce6b6 [running]> on host 9b878320bbfc
[2024-03-27 19:11:43,938] {taskinstance.py:1571} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=bigdag
AIRFLOW_CTX_TASK_ID=upload_metadata_data_to_snowflake_task
AIRFLOW_CTX_EXECUTION_DATE=2024-03-27T18:58:33.387305+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=d8915ad7-c541-434a-9d20-2245a1dce6b6
[2024-03-27 19:11:43,944] {logging_mixin.py:115} INFO - {'conf': <***.configuration.AirflowConfigParser object at 0xffffa6231650>, 'dag': <DAG: bigdag>, 'dag_run': <DagRun bigdag @ 2024-03-27 18:58:33.387305+00:00: d8915ad7-c541-434a-9d20-2245a1dce6b6, externally triggered: True>, 'data_interval_end': DateTime(2024, 3, 27, 18, 58, 33, 387305, tzinfo=Timezone('UTC')), 'data_interval_start': DateTime(2024, 3, 27, 18, 58, 33, 387305, tzinfo=Timezone('UTC')), 'ds': '2024-03-27', 'ds_nodash': '20240327', 'execution_date': <Proxy at 0xffff801b53c0 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'execution_date', DateTime(2024, 3, 27, 18, 58, 33, 387305, tzinfo=Timezone('UTC')))>, 'inlets': [], 'logical_date': DateTime(2024, 3, 27, 18, 58, 33, 387305, tzinfo=Timezone('UTC')), 'macros': <module '***.macros' from '/home/***/.local/lib/python3.7/site-packages/***/macros/__init__.py'>, 'next_ds': <Proxy at 0xffff801b5410 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'next_ds', '2024-03-27')>, 'next_ds_nodash': <Proxy at 0xffff801b5460 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'next_ds_nodash', '20240327')>, 'next_execution_date': <Proxy at 0xffff801b54b0 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'next_execution_date', DateTime(2024, 3, 27, 18, 58, 33, 387305, tzinfo=Timezone('UTC')))>, 'outlets': [], 'params': {'s3_uri': 's3://cfainstitute-learning-outcomes-raw/t1/Level1_combined.pdf'}, 'prev_data_interval_start_success': DateTime(2024, 3, 27, 18, 49, 47, 272206, tzinfo=Timezone('UTC')), 'prev_data_interval_end_success': DateTime(2024, 3, 27, 18, 49, 47, 272206, tzinfo=Timezone('UTC')), 'prev_ds': <Proxy at 0xffff801b5500 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'prev_ds', '2024-03-27')>, 'prev_ds_nodash': <Proxy at 0xffff801b5550 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'prev_ds_nodash', '20240327')>, 'prev_execution_date': <Proxy at 0xffff801b55a0 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'prev_execution_date', DateTime(2024, 3, 27, 18, 58, 33, 387305, tzinfo=Timezone('UTC')))>, 'prev_execution_date_success': <Proxy at 0xffff801b55f0 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'prev_execution_date_success', DateTime(2024, 3, 27, 18, 49, 47, 272206, tzinfo=Timezone('UTC')))>, 'prev_start_date_success': DateTime(2024, 3, 27, 18, 49, 47, 755287, tzinfo=Timezone('UTC')), 'run_id': 'd8915ad7-c541-434a-9d20-2245a1dce6b6', 'task': <Task(PythonOperator): upload_metadata_data_to_snowflake_task>, 'task_instance': <TaskInstance: bigdag.upload_metadata_data_to_snowflake_task d8915ad7-c541-434a-9d20-2245a1dce6b6 [running]>, 'task_instance_key_str': 'bigdag__upload_metadata_data_to_snowflake_task__20240327', 'test_mode': False, 'ti': <TaskInstance: bigdag.upload_metadata_data_to_snowflake_task d8915ad7-c541-434a-9d20-2245a1dce6b6 [running]>, 'tomorrow_ds': <Proxy at 0xffff801b5640 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'tomorrow_ds', '2024-03-28')>, 'tomorrow_ds_nodash': <Proxy at 0xffff801b5690 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'tomorrow_ds_nodash', '20240328')>, 'ts': '2024-03-27T18:58:33.387305+00:00', 'ts_nodash': '20240327T185833', 'ts_nodash_with_tz': '20240327T185833.387305+0000', 'var': {'json': None, 'value': None}, 'conn': None, 'yesterday_ds': <Proxy at 0xffff801b56e0 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'yesterday_ds', '2024-03-26')>, 'yesterday_ds_nodash': <Proxy at 0xffff801b5730 with factory functools.partial(<function lazy_mapping_from_context.<locals>._deprecated_proxy_factory at 0xffff82d16a70>, 'yesterday_ds_nodash', '20240326')>, 'templates_dict': None}
[2024-03-27 19:11:43,974] {logging_mixin.py:115} INFO - Ds Level1_combined_metadata.csv
[2024-03-27 19:11:43,976] {connection.py:300} INFO - Snowflake Connector for Python Version: 3.0.4, Python Version: 3.7.13, Platform: Linux-6.6.16-linuxkit-aarch64-with-debian-11.3
[2024-03-27 19:11:43,978] {connection.py:1013} INFO - This connection is in OCSP Fail Open Mode. TLS Certificates would be checked for validity and revocation status. Any other Certificate Revocation related exceptions or OCSP Responder failures would be disregarded in favor of connectivity.
[2024-03-27 19:11:43,982] {connection.py:1030} INFO - Setting use_openssl_only mode to False
[2024-03-27 19:11:46,034] {cursor.py:806} INFO - query: [CREATE DATABASE IF NOT EXISTS CFAInstitute]
[2024-03-27 19:11:46,195] {cursor.py:819} INFO - query execution done
[2024-03-27 19:11:46,196] {cursor.py:962} INFO - Number of results in first chunk: 1
[2024-03-27 19:11:46,198] {cursor.py:806} INFO - query: [USE DATABASE CFAInstitute]
[2024-03-27 19:11:46,434] {cursor.py:819} INFO - query execution done
[2024-03-27 19:11:46,435] {cursor.py:962} INFO - Number of results in first chunk: 1
[2024-03-27 19:11:46,436] {cursor.py:806} INFO - query: [USE WAREHOUSE BIGDATA]
[2024-03-27 19:11:46,705] {cursor.py:819} INFO - query execution done
[2024-03-27 19:11:46,707] {cursor.py:962} INFO - Number of results in first chunk: 1
[2024-03-27 19:11:46,708] {cursor.py:806} INFO - query: [CREATE TABLE IF NOT EXISTS Metadata ( PDF_NAME String, Title String, Publisher S...]
[2024-03-27 19:11:46,930] {cursor.py:819} INFO - query execution done
[2024-03-27 19:11:46,930] {cursor.py:962} INFO - Number of results in first chunk: 1
[2024-03-27 19:11:46,930] {cursor.py:806} INFO - query: [TRUNCATE TABLE Metadata]
[2024-03-27 19:11:47,463] {cursor.py:819} INFO - query execution done
[2024-03-27 19:11:47,463] {cursor.py:962} INFO - Number of results in first chunk: 1
[2024-03-27 19:11:47,464] {logging_mixin.py:115} INFO - /opt/***/dags/resources/d8915ad7-c541-434a-9d20-2245a1dce6b6/Level1_combined_metadata.csv
[2024-03-27 19:11:47,465] {cursor.py:806} INFO - query: [PUT file:///opt/***/dags/resources/d8915ad7-c541-434a-9d20-2245a1dce6b6/Leve...]
[2024-03-27 19:11:47,618] {cursor.py:819} INFO - query execution done
[2024-03-27 19:11:47,918] {cursor.py:806} INFO - query: [COPY INTO Metadata ON_ERROR=CONTINUE FILE_FORMAT = (FIELD_OPTIONALLY_ENCLOSED_BY...]
[2024-03-27 19:11:49,286] {cursor.py:819} INFO - query execution done
[2024-03-27 19:11:49,293] {cursor.py:962} INFO - Number of results in first chunk: 3
[2024-03-27 19:11:49,295] {python.py:173} INFO - Done. Returned value was: completed
[2024-03-27 19:11:49,370] {taskinstance.py:1400} INFO - Marking task as SUCCESS. dag_id=bigdag, task_id=upload_metadata_data_to_snowflake_task, execution_date=20240327T185833, start_date=20240327T191143, end_date=20240327T191149
[2024-03-27 19:11:49,448] {local_task_job.py:156} INFO - Task exited with return code 0
[2024-03-27 19:11:49,477] {local_task_job.py:273} INFO - 1 downstream tasks scheduled from follow-on schedule check
